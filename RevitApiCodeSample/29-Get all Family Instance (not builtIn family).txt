public static class JtElementExtensionMethods
{
  public static bool IsPhysicalElement( 
    this Element e )
  {
    if( e.Category == null ) return false;
    if( e.ViewSpecific ) return false;
    // exclude specific unwanted categories
    if( ( (BuiltInCategory) e.Category.Id.IntegerValue ) == BuiltInCategory.OST_HVAC_Zones ) return false;
 
    return e.Category.CategoryType == CategoryType.Model && e.Category.CanAddSubcategory;
  }
}

IEnumerable<Element> SelectAllPhysicalElements(
  Document doc )
{
  return new FilteredElementCollector( doc )
    .WhereElementIsNotElementType()
    .Where( e => e.IsPhysicalElement() );
}