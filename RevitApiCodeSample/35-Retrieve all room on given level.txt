#region Retrieve all rooms on a given level
    /// <summary>
    /// Retrieve all rooms on a given level for
    /// https://forums.autodesk.com/t5/revit-api-forum/collect-all-room-in-leve-xx/m-p/6936959
    /// </summary>
    public IEnumerable<Room> GetRoomsOnLevel(
      Document doc,
      ElementId idLevel )
    {
      return new FilteredElementCollector( doc )
        .WhereElementIsNotElementType()
        .OfClass( typeof( SpatialElement ) )
        .Where( e => e.GetType() == typeof( Room ) )
        .Where( e => e.LevelId.IntegerValue.Equals(
          idLevel.IntegerValue ) )
        .Cast<Room>();
    }
    #endregion // Retrieve all rooms on a given level