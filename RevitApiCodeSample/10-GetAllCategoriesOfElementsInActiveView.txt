doc = uidoc.Document;

//Create collector to collect all elements on active view
FilteredElementCollector collector = new FilteredElementCollector(doc, doc.ActiveView.Id);

//get distinct categories of elements in the active view
var categories =
                collector                    
                    .ToElements()
                    .Select(x => x.Category)
                    .Distinct(new CategoryComparer())
                    .ToList();


class CategoryComparer : IEqualityComparer<Category>
    {
        #region Implementation of IEqualityComparer<in Category>

        public bool Equals(Category x, Category y)
        {          
            if (x == null || y == null) return false;

            return x.Id.Equals(y.Id);
        }

        public int GetHashCode(Category obj)
        {
            return obj.Id.IntegerValue;
        }

        #endregion
    }